# vscode_fanyi_core

VSCode åˆ’è¯ç¿»è¯‘æ’ä»¶çš„æ ¸å¿ƒç¿»è¯‘ç¨‹åºï¼Œä½¿ç”¨ Go è¯­è¨€ç¼–å†™ï¼Œè´Ÿè´£å¤„ç†ç¿»è¯‘ API è°ƒç”¨å’Œè¿›ç¨‹é€šä¿¡ã€‚

## ğŸ“‹ ç›®å½•

- [é€šä¿¡åè®®](#é€šä¿¡åè®®)
- [å·¥ä½œæµç¨‹](#å·¥ä½œæµç¨‹)
- [è¯·æ±‚é˜Ÿåˆ—æœºåˆ¶](#è¯·æ±‚é˜Ÿåˆ—æœºåˆ¶)
- [æ—¥å¿—åŠŸèƒ½](#æ—¥å¿—åŠŸèƒ½)
- [å¼€å‘](#å¼€å‘)

## ğŸ”§ é€šä¿¡åè®®

`vscode_fanyi_core` æ˜¯ä¸€ä¸ª**å‘½ä»¤è¡Œç¨‹åº**ï¼Œé€šè¿‡ **stdin/stdout** ä¸æ’ä»¶è¿›è¡Œ JSON æ ¼å¼çš„è¿›ç¨‹é—´é€šä¿¡ã€‚

### è¯·æ±‚æ ¼å¼

```json
{
  "command": "init|translateText|exit",
  "data": { ... }
}
```

### å“åº”æ ¼å¼

```json
{
  "code": 0,
  "message": "æˆåŠŸ/é”™è¯¯ä¿¡æ¯",
  "data": { ... }
}
```

## ğŸ”„ å·¥ä½œæµç¨‹

### 1. è¿›ç¨‹å¯åŠ¨

- æ’ä»¶é€šè¿‡ `spawn()` å¯åŠ¨ `fanyi_core.exe` è¿›ç¨‹
- é…ç½® `stdio: ['pipe', 'pipe', 'pipe']` å»ºç«‹æ ‡å‡†è¾“å…¥è¾“å‡ºé€šé“

### 2. åˆå§‹åŒ–é˜¶æ®µ

```json
// æ’ä»¶å‘é€
{
  "command": "init",
  "data": {
    "tencent_ak": "your_ak",
    "tencent_secret": "your_secret"
  }
}

// æ ¸å¿ƒç¨‹åºå“åº”
{
  "code": 0,
  "message": "åˆå§‹åŒ–æˆåŠŸ",
  "data": { "success": true }
}
```

### 3. ç¿»è¯‘è¯·æ±‚

```json
// æ’ä»¶å‘é€
{
  "command": "translateText",
  "data": {
    "text": "Hello",
    "src": "en",
    "to": "zh"
  }
}

// æ ¸å¿ƒç¨‹åºå“åº”
{
  "code": 0,
  "message": "ç¿»è¯‘æˆåŠŸ",
  "data": {
    "text": "ä½ å¥½",
    "original": "Hello",
    "src": "en",
    "to": "zh"
  }
}
```

### 4. é€€å‡ºç¨‹åº

```json
{
  "command": "exit",
  "data": {}
}
```

## ğŸ“¦ è¯·æ±‚é˜Ÿåˆ—æœºåˆ¶

æ’ä»¶ä½¿ç”¨**è¯·æ±‚é˜Ÿåˆ—**ç®¡ç†å¼‚æ­¥è¯·æ±‚ï¼š

- æ¯ä¸ªè¯·æ±‚åˆ†é…ä¸€ä¸ª Promise
- è¯·æ±‚æŒ‰é¡ºåºå‘é€åˆ°æ ¸å¿ƒç¨‹åº
- å“åº”æŒ‰é¡ºåºä»é˜Ÿåˆ—ä¸­å–å‡ºå¹¶è§£æ
- æ”¯æŒ 30 ç§’è¶…æ—¶æœºåˆ¶

## ğŸ“ æ—¥å¿—åŠŸèƒ½

æ ¸å¿ƒç¨‹åºæ”¯æŒæ—¥å¿—è®°å½•åŠŸèƒ½ï¼š

- å½“ `log_file_enable` é…ç½®ä¸º `true` æ—¶ï¼Œè®°å½•ç¿»è¯‘æ—¥å¿—åˆ° `app.log`
- æ—¥å¿—æ–‡ä»¶è¶…è¿‡ 10MB æ—¶è‡ªåŠ¨æ¸…ç©º
- è®°å½•å†…å®¹ï¼šç¿»è¯‘è¯·æ±‚ã€æˆåŠŸ/å¤±è´¥ä¿¡æ¯ã€é”™è¯¯å †æ ˆ

## ğŸ› ï¸ å¼€å‘

### é¡¹ç›®ç»“æ„

```
vscode_fanyi_core/
â”œâ”€â”€ main.go                   # ä¸»ç¨‹åºå…¥å£
â”œâ”€â”€ pkg/
â”‚   â”œâ”€â”€ fanyi/               # ç¿»è¯‘æœåŠ¡å®ç°
â”‚   â”‚   â””â”€â”€ tencent.go       # è…¾è®¯ç¿»è¯‘ API å®ç°
â”‚   â””â”€â”€ settings/            # é…ç½®ç®¡ç†
â”‚       â””â”€â”€ apikey.go        # API å¯†é’¥ç®¡ç†
â”œâ”€â”€ go.mod
â””â”€â”€ go.sum
```

### ç¼–è¯‘

```bash
# Windows
go build -o fanyi_core.exe

# Linux
go build -o fanyi_core

# macOS
go build -o fanyi_core
```

### è¿è¡Œæµ‹è¯•

```bash
go test ./...
```

### è°ƒè¯•

ç›´æ¥è¿è¡Œç¼–è¯‘åçš„å¯æ‰§è¡Œæ–‡ä»¶ï¼Œé€šè¿‡ stdin è¾“å…¥ JSON è¿›è¡Œæµ‹è¯•ï¼š

```bash
# Windows
echo {"command":"init","data":{"tencent_ak":"test","tencent_secret":"test"}} | fanyi_core.exe

# Linux/macOS
echo '{"command":"init","data":{"tencent_ak":"test","tencent_secret":"test"}}' | ./fanyi_core
```

## ğŸ“ è®¸å¯è¯

MIT
